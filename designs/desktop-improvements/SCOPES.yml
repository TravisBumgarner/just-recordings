milestones:
  - id: 1
    title: Desktop Improvements
    description: Improvements to desktop app - taskbar countdown, webcam setup, upload toggle
    base_branch: main
    github_milestone: 40

tasks:
  # Feature 0: Fix Recording Flow (Critical Bug)
  - id: 7
    title: Fix recording flow - screen selection before countdown
    description: |
      The current flow shows countdown THEN asks for screen selection. This is backwards.
      Screen picker should appear when user clicks Start in settings, THEN countdown starts.
      If user cancels screen picker, return to settings without showing countdown.
    acceptance_criteria:
      - Screen picker appears when user clicks Start in settings modal
      - If user cancels screen picker flow returns to settings (no countdown)
      - Countdown only starts after successful screen selection
      - Recording uses the previously selected screen stream
      - Flow works correctly on both web and desktop
    github_issue: 265
    milestone: 1
    status: testing
    depends_on: []

  # Feature 1: Webcam Setup Wizard (simplest)
  - id: 1
    title: Add webcam/camera step to setup wizard
    description: |
      Add a camera permissions step to the desktop setup wizard, following the same pattern
      as existing screen recording and microphone steps.
    acceptance_criteria:
      - Camera step appears in setup wizard after microphone step
      - User can test camera permissions
      - User can request camera permissions
      - User can open system preferences for camera
      - Step shows appropriate status (granted/denied/unknown)
    github_issue: 259
    milestone: 1
    status: pending
    depends_on: []

  # Feature 2: Upload Toggle Setting
  - id: 2
    title: Add auto-upload toggle setting
    description: |
      Add a setting to enable/disable automatic upload after recording completes.
      When disabled, recordings save locally but don't auto-upload.
    acceptance_criteria:
      - Toggle setting exists in recording settings panel
      - Setting persists to localStorage
      - When enabled (default) recordings upload automatically after completion
      - When disabled recordings save locally but don't auto-upload
      - Setting label is clear - Auto-upload after recording
    github_issue: 260
    milestone: 1
    status: pending
    depends_on: []

  # Feature 3: Taskbar Countdown (most complex, broken into subtasks)
  - id: 3
    title: Add IPC handlers for countdown state
    description: |
      Add Electron IPC handlers to communicate countdown state between renderer and main process.
      This is the foundation for the taskbar countdown feature.
    acceptance_criteria:
      - Main process has handlers for countdown:start, countdown:tick, countdown:end
      - Preload script exposes countdown API to renderer
      - TypeScript types are properly defined
      - IPC messages flow correctly from renderer to main
    github_issue: 261
    milestone: 1
    status: pending
    depends_on: []

  - id: 4
    title: Show countdown progress in taskbar/dock
    description: |
      During countdown, show progress in the system taskbar (Windows) or dock (macOS).
    acceptance_criteria:
      - Windows taskbar shows progress bar during countdown
      - macOS dock badge shows countdown number (3, 2, 1)
      - Progress updates smoothly with each countdown tick
      - Progress clears when countdown completes
    github_issue: 262
    milestone: 1
    status: pending
    depends_on: [3]

  - id: 5
    title: Hide window during countdown and recording
    description: |
      Hide the main Electron window during countdown so the countdown only shows in taskbar/dock.
    acceptance_criteria:
      - Window hides when countdown starts
      - Window remains hidden during recording
      - Window can be restored when recording stops (or via system tray)
      - Works correctly on both macOS and Windows
    github_issue: 263
    milestone: 1
    status: pending
    depends_on: [3]

  - id: 6
    title: Send countdown IPC messages from CountdownOverlay
    description: |
      Update CountdownOverlay component to send IPC messages to the Electron main process during countdown.
    acceptance_criteria:
      - Sends countdown:start when countdown begins
      - Sends countdown:tick with seconds remaining on each tick
      - Sends countdown:end when countdown completes
      - Only sends messages when running in Electron (check window.electron exists)
    github_issue: 264
    milestone: 1
    status: pending
    depends_on: [3]
